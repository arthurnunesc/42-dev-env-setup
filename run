##!/usr/bin/env sh

$USER=$(whoami) # Making sure USER variable exists

# Defining $HOME folder
read -r "do you want to use /sgoinfre/Perso/$USER as your home folder? [y/N]" OPTION
if [ "$OPTION" = 'y' ] || [ "$OPTION" = 'Y' ]; then
  HOME="/sgoinfre/Perso/$USER"
fi
BIN_DIR="$HOME/.local/bin"

# Making sure folders exist before installing things into them
if [ -d $HOME ]; then
    echo "$HOME directory already exists."
else
    mkdir $HOME
    chmod -R 700 $HOME
fi
if [ -d $BIN_DIR ]; then
    echo "$BIN_DIR directory already exists."
else
    mkdir -p $BIN_DIR
fi

# Installing brew, chezmoi, neovim and kitty
if [ -f $BIN_DIR/brew ]; then
    echo "brew is already installed."
else
    echo "installing brew..."
    curl -L https://github.com/Homebrew/brew/tarball/master | tar -xz --strip 1 -C $HOME/.local
fi

echo "fetching repos..."
brew update

echo "upgrading packages..."
brew upgrade

echo "installing packages..."
brew install chezmoi
brew install neovim
brew install --cask kitty

echo "cleaning up..."
brew cleanup

# Dotfiles
chezmoi init --apply arthurnunesc
